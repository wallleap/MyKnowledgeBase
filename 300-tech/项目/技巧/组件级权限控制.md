---
title: 组件级权限控制
date: 2024-10-08T03:53:23+08:00
updated: 2024-10-08T03:53:32+08:00
dg-publish: false
---

使用自定义指令的缺点：

- 组件不显示，但组件仍然会挂载
- 还是会发送请求
- 秒敢操作

所以还是需要用组件控制

`Authority.vue`

```vue
<template>
  <slot v-if="roles.includes(auth)"></slot>
</template>

<script setup>
import { useRoles } from '../store'

defineProps(['auth'])

const roles = useRoles()
</script>
```

store 中假设有一个角色列表

```js
export function useRoles() {
  return ['user']
}
```

使用

```vue
<template>
  <Authority :auth="admin">
    <Button>删除</Button>
  </Authority>
</template>
```

