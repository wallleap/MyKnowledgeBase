---
title: å‰ç«¯æ€§èƒ½ - é¦–æ¬¡åŠ è½½ä¼˜åŒ– 70%
date: 2023-08-03T05:50:00+08:00
updated: 2024-08-21T10:32:46+08:00
dg-publish: false
aliases:
  - å‰ç«¯æ€§èƒ½ - é¦–æ¬¡åŠ è½½ä¼˜åŒ– 70%
author: Luwang
category: web
comments: true
cover: //cdn.wallleap.cn/img/post/1.jpg
description: æ–‡ç« æè¿°
image-auto-upload: true
keywords:
  - å…³é”®è¯1
  - å…³é”®è¯2
  - å…³é”®è¯3
rating: 1
source: #
tags:
  - web
url: //myblog.wallleap.cn/post/1
---

## é¡¹ç›®èƒŒæ™¯

ä¸­å°é¡¹ç›®ï¼ŒVue-cli3 + vue2 + webpack4

## ç›®æ ‡

ç¼©çŸ­ç™½å±æ—¶é—´ï¼Œç”¨æˆ·èƒ½å¤Ÿæ›´å¿«çš„çœ‹åˆ°æˆ‘çš„é¡µé¢ï¼

> ç™½å±æ—¶é—´ï¼šä»æ‰“å¼€é¡µé¢åˆ°çœ‹åˆ°é¡µé¢ï¼Œä¸­é—´ç™½å±åœç•™çš„æ—¶é—´ã€‚

## æ–¹å‘

1.å‡å°‘èµ„æºä½“ç§¯ï¼Œä»è€Œç¼©çŸ­è¯·æ±‚æ—¶é—´

2.å‡å°‘èµ„æºè¯·æ±‚ä¸ªæ•°ï¼Œä»è€Œç¼©çŸ­ç­‰å¾…æ—¶é—´

## å‡†å¤‡å·¥ä½œ

### å¦‚ä½•çŸ¥é“æ‰“åŒ…ä½“ç§¯ï¼Ÿ

æ‰“åŒ…æ„å»ºçš„æ—¶å€™ï¼Œä½¿ç”¨ `--report` å‘½ä»¤ï¼š

```sh
vue-cli-service build --report
```

æ‰“åŒ…ç»“æŸåï¼Œä¼šåœ¨ dist ç›®å½•é‡Œé¢ç”Ÿæˆä¸€ä¸ª report html æ–‡ä»¶ï¼Œé‡Œé¢ä¼šæ˜¾ç¤ºä½ æ‰“åŒ…ä½“ç§¯åˆ†å¸ƒæƒ…å†µï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®æƒ…å†µï¼Œä¾§é‡ä¼˜åŒ–ã€‚

å¤§æ¦‚é•¿è¿™æ ·ï¼ˆå›¾ç‰‡æ¥è‡ªç½‘ç»œï¼Œå¹¶éæˆ‘é¡¹ç›®å®é™…æƒ…å†µï¼‰

![](https://cdn.wallleap.cn/img/pic/illustration/202308031751900.png)

### å¦‚ä½•çŸ¥é“æ‰“åŒ…é€Ÿåº¦

æœ‰çš„äººå¯ä»¥é€šè¿‡ `--progress` æŸ¥çœ‹åˆ°æ‰“åŒ…è€—æ—¶ï¼Œä½†æ˜¯å¯¹äºæˆ‘é¡¹ç›®æ— ç”¨ï¼Œä½¿ç”¨ **ProgressBarPlugin** æ’ä»¶è§£å†³

```js
config.plugins.push(new ProgressBarPlugin())}
```

## å¼€å§‹å‘åŠ›ğŸš€ğŸš€ğŸš€

### 0.åˆ é™¤ä½ æ²¡ç”¨åˆ°çš„ä»£ç 

åœ¨ webpack é‡ŒåŠ ä¸Šä¸‹é¢æ’ä»¶ï¼Œæ¯æ¬¡ serve çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ª json æ–‡ä»¶ï¼Œé‡Œé¢ä¼šæ˜¾ç¤ºä½ æ²¡ç”¨åˆ°çš„æ–‡ä»¶

```js
config.plugin('uselessFile')
.use(new UselessFile({     
    root:path.resolve(__dirname, './src'),     
    out:'./fileList.json',     
    clean:false,       
    exclude: /node_modules/ 
}))  
}    
```

### 1.è®©æ²¡æœ‰æŒ‰éœ€å¼•å…¥çš„åº“æŒ‰éœ€å¼•å…¥

æ¯”å¦‚ï¼šlodash

ä¹‹å‰çš„å¼•å…¥æ–¹å¼ï¼š

```js
import lodash from 'lodash'
```

ä½¿ç”¨æŒ‰éœ€å¼•å…¥

```js
import find from 'lodash/find
```

æ‰“åŒ…ä½“ç§¯å°‘äº†å¾ˆå¤š...

### 2.å¼•å…¥ä¸€ä¸ªåº“æœ€å°çš„èµ„æº

ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸€ä¸ªåº“å« aï¼Œæˆ‘ä»¬ä¸€èˆ¬å¼•å…¥æ–¹å¼ä¸º

```js
import a from 'a'
```

æˆ‘ä»¬å¯ä»¥å» node\_modules é‡Œé¢æœç´¢æŸ¥çœ‹ä¸€ä¸‹èµ„æºçš„å¤§å°ï¼Œæœ‰ä¹ˆæœ‰ a.min.js æˆ–è€…æ˜¯ a.min.min.jsï¼Œæ‰¾ä¸ªä½“ç§¯æœ€å°çš„ï¼

æ¯”å¦‚ï¼š

```js
import vis from 'vis-network'
```

æ”¹æˆ

```js
import vis from 'vis-network/dist/vis-network.min'
```

æ‰“åŒ…ä½“ç§¯å°‘äº†å¾ˆå¤š...

### 3.æ›¿æ¢æ›´å°çš„åº“

æ¯”å¦‚ï¼šmoment

åˆšå¼€å§‹æˆ‘å‚è€ƒäº†ç½‘ä¸Šçš„æ–¹æ¡ˆï¼Œåœ¨ webpack é‡Œé¢é…ç½®ï¼Œå¿½ç•¥ä¸ä¼šä½¿ç”¨åˆ°çš„ moment éƒ¨åˆ†ï¼Œä»è€Œè¾¾åˆ°å‡å°‘æ‰“åŒ…ä½“ç§¯çš„æ•ˆæœï¼š

```js
webpack.IgnorePlugin(/^\.\/locale$/, /moment$/));
```

æˆåŠŸè®©æ‰“åŒ…å‡ºæ¥çš„ moment ä½“ç§¯ä» 600 å¤š k é™åˆ°äº† 160 å¤š kï¼Œæˆæœéå¸¸æ˜¾è‘—ï¼

ä½†æ˜¯æƒ³ç€ 100 å¤š k å¯¹äºæˆ‘åªä½¿ç”¨äº†ç®€å•çš„æ—¶é—´å‡½æ•°æ¥è¯´ï¼Œè¿˜æ˜¯å¾ˆå¤§äº†ï¼Œåæ¥ï¼š

> æŠ›å¼ƒ momentï¼Œä½¿ç”¨**dayjs**ï¼

ç„¶åæ‰“åŒ…å‡ºæ¥åªæœ‰ 6kï¼ï¼ï¼6Kï¼ï¼ï¼

### 4.å¼€å¯ Gzip

```js
const productionGzipExtensions = ['js','css']
const gzipCompressPlugin = new CompressionWebpackPlugin({        
    filename: '[path].gz[query]',     
    algorithm: 'gzip',       
    test: new RegExp('\\.(' + productionGzipExtensions.join('|') + ')$'), 
    threshold: 10240, 
    minRatio: 0.8, 
    })   
config.plugins.push(gzipCompressPlugin) 
```

### 5.ç”Ÿäº§ç¯å¢ƒåˆ é™¤ console ç­‰

æ³¨æ„ï¼Œå®‰è£… `terser-webpack-plugin` ç‰ˆæœ¬è¦æ³¨æ„ä¸ä½  webpack çš„å¯¹åº”ï¼Œä¸ç„¶ä¼šå®‰è£…å¤±è´¥å“¦ï¼æˆ‘ä½¿ç”¨çš„æ˜¯ 4.2.3

```js
let terserOption = new TerserPlugin({     
  terserOptions: {            
  test: /\.js(\?.*)?$/i,        
  exclude: /\/node_modules/,    
  warnings: false,           
  mangle: true, 
  compress: {   
   drop_console: true,             
   drop_debugger: true,        
   pure_funcs: ['console.log'] 
 }
)}
config.plugins.push(terserOption)  
```

### 6.ç”Ÿäº§å…³é—­ sourcemap

```js
productionSourceMap: false
```

### 7.åˆ é™¤ prefetch

```js
config.plugins.delete("prefetch")
```

åˆ é™¤äº†è¿™ä¸ªï¼Œé¦–æ¬¡åŠ è½½æ—¶é—´ä¼˜åŒ–äº†å¥½å¤š...

## æ•ˆæœå¦‚ä½•ï¼Ÿ

é¦–æ¬¡åŠ è½½é€Ÿåº¦ä¼˜åŒ– 70%

æ‰“åŒ…ä½“ç§¯ä¼˜åŒ– 60%

æŒç»­ä¼˜åŒ–ä¸­...

## æœ€å

æ„Ÿè°¢ç½‘ä¸Šæœåˆ®åˆ°çš„ä¸€äº›æ–¹æ¡ˆï¼Œæ²¡æœ‰ä¸€ä¸€è®°å½•
