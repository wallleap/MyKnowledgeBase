---
title: 019-BOM
date: 2023-03-19 20:29
updated: 2023-03-19 22:33
cover: //cdn.wallleap.cn/img/post/1.jpg
image-auto-upload: true
author: Luwang
comments: true
aliases:
  - 019-BOM
rating: 1
tags:
  - JavaScript
category: web
keywords:
  - å…³é”®è¯1
  - å…³é”®è¯2
  - å…³é”®è¯3
description: æ–‡ç« æè¿°
source: null
url: //myblog.wallleap.cn/post/1
---

æµè§ˆå™¨å¯¹è±¡æ¨¡å‹

## navigator

æµè§ˆå™¨ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥æ‰“å° `navigator` æŸ¥çœ‹

å¸¸ç”¨ `navigator.userAgent` ç”¨æˆ·ä»£ç†ï¼Œå¯ä»¥æŸ¥çœ‹ç”¨æˆ·æµè§ˆå™¨ã€ç³»ç»Ÿã€è®¾å¤‡ç­‰ä¿¡æ¯

åˆ¤æ–­è®¾å¤‡

```js
const isIPhone = () => /iphone/i.test(navigator.userAgent)
const isIOS = () => /iphone|ipad/i.test(navigator.userAgent)
const isAndroid = () => /android/i.test(navigator.userAgent)
```

## history

ç”¨äºè®¾ç½®æˆ–è·å–æµè§ˆå™¨å‰è¿›æˆ–åé€€çš„ä¿¡æ¯

- `history.go(n)`  è½½å…¥

- `history.back()`  å›é€€

- `history.forward()`  å‰è¿›

- `history.pushState(stateObject, title, URL)`  æ·»åŠ åˆ°å†å²è®°å½•æ¡ç›®

- `history.replaceState(stateObject, title, URL)`  ä¿®æ”¹å†å²è®°å½•æ¡ç›®

- `history.state`  ä¸Šé¢ä¸¤æ¡ä¸­èµ·çš„åå­—/ä¿¡æ¯ï¼ˆå¯¹è±¡ï¼‰

è¡¨è±¡æ˜¯ä¿®æ”¹ URLï¼Œçº¯ç²¹åœ°ä¿®æ”¹ URL ä¸è·³è½¬

é€šè¿‡å†å²è®°å½•æ¡ç›®å’Œæ˜¾ç¤ºéšè—å®ç°ä¼ªé€ å‰è¿›åé€€

```html
<!-- é¦–å…ˆæ˜¯å…¨éƒ¨é¡µé¢éƒ½éšè—ï¼Œåªæ˜¾ç¤ºå½“å‰é¡µé¢ -->
```

`window.onpopstate`  åé€€æ—¶è§¦å‘

## æœ¬åœ°å­˜å‚¨

æ•°æ®æœ¬åœ°æŒä¹…åŒ–

### localStorage

- ç”¨äºå°†å¤§é‡æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼ˆæœ€å¤§ 5Mï¼‰
- ä¿å­˜åæ•°æ®æ°¸ä¸è¿‡æœŸï¼Œé™¤éç”¨ JS æ‰‹åŠ¨æ¸…é™¤
- ä¸å‚ä¸ç½‘ç»œä¼ è¾“
- åªå­˜å‚¨å­—ç¬¦ä¸²
	- å­˜å‚¨å¸ƒå°”å€¼çš„æ—¶å€™æœ€å¥½ç›´æ¥å­˜ yes or no
	- å­˜å‚¨å¯¹è±¡çš„è¯ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ª API
		- `localStorage.setItem('obj', JSON.stringify(obj))`  å¯¹è±¡è½¬æˆå­—ä¸²
		- `JSON.parse(localStorage.getItem('obj'))`  å­—ä¸²è½¬æˆå¯¹è±¡

ä½¿ç”¨

- `localStorage.setItem(key, value)`
- `localStorage.getItem(key)`  ä¸å­˜åœ¨å¾—åˆ° `null`ï¼Œå­˜åœ¨å¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²ï¼ˆå¯ä»¥ä½¿ç”¨å…¶ä»–å‡½æ•°è½¬æˆå…¶ä»–æ•°æ®ç±»å‹ï¼‰
- `localStorage.removeItem(key)`

åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ï¼šæ§åˆ¶å°-åº”ç”¨-å­˜å‚¨-æœ¬åœ°å­˜å‚¨ç©ºé—´-å½“å‰ç½‘ç«™

### cookie

- å­˜å‚¨åœ¨æµè§ˆå™¨ä¸Šçš„ä¸€å°æ®µæ•°æ®ï¼Œç”¨æ¥è®°å½•æŸäº›å½“é¡µé¢å…³é—­æˆ–åˆ·æ–°åä»ç„¶éœ€è¦è®°å½•çš„ä¿¡æ¯
- å¯ä»¥ç”¨ JS åœ¨æµè§ˆå™¨ç›´æ¥è®¾ç½®ï¼ˆç”¨äºè®°å½•ä¸æ•æ„Ÿçš„ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åï¼‰ï¼Œä¹Ÿå¯åœ¨æœåŠ¡ç«¯ä½¿ç”¨ HTTP åè®®è§„å®šçš„ `set-cookie` æ¥è®©æµè§ˆå™¨ä¸­ä¸‹ cookieï¼Œè¿™ä½¿æœ€å¸¸è§çš„åšæ³•
- æ¯æ¬¡ç½‘ç»œè¯·æ±‚ Request Headers ä¸­éƒ½ä¼šå¸¦ä¸Š cookieï¼Œæ‰€ä»¥å¦‚æœ cookie å¤ªå¤šå¤ªå¤§ä¼šå¯¹ä¼ è¾“æ•ˆç‡æœ‰å½±å“
- æœ€å¤§å®¹é‡ä¸º 4kï¼Œæœ‰è¿‡æœŸæ—¶é—´

Cookie è®¾ç½®æ—¶çš„å‚æ•°ï¼š

- pathï¼šè¡¨ç¤º cookie å½±å“åˆ°çš„è·¯å¾„ï¼ŒåŒ¹é…è¯¥è·¯å¾„æ‰å‘é€è¿™ä¸ª cookie
- expires å’Œ maxAgeï¼šå‘Šè¯‰æµè§ˆå™¨ cookie ä»€ä¹ˆæ—¶å€™è¿‡æœŸï¼ŒmaxAge æ˜¯ cookie å¤šä¹…åè¿‡æœŸçš„ç›¸å¯¹æ—¶é—´
- secureï¼šå½“ secure å€¼ä¸º true æ—¶ï¼Œcookie åœ¨ HTTP ä¸­æ˜¯æ— æ•ˆçš„ï¼Œåœ¨ HTTPS ä¸­æ‰æœ‰æ•ˆ
- httpOnlyï¼šæµè§ˆå™¨ä¸å…è®¸è„šæœ¬æ“ä½œ `document.cookie` å»æ›´æ”¹ cookieã€‚ä¸€èˆ¬æƒ…å†µä¸‹éƒ½åº”è¯¥è®¾ç½®ä¸º trueï¼Œè¿™æ ·å¯ä»¥é¿å…è¢« xss æ”»å‡»æ‹¿åˆ° cookie

åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ï¼šç½‘ç»œ-è¯·æ±‚å¤´ ï½œ åº”ç”¨-å­˜å‚¨-Cookie-å½“å‰ç½‘ç«™

### session

- ç”¨æˆ·åœ¨è¾“å…¥ç”¨æˆ·åå¯†ç æäº¤ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯éªŒè¯é€šè¿‡åä¼šåˆ›å»ºä¸€ä¸ª session å¯¹è±¡ç”¨äºè®°å½•ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ï¼Œè¿™ä¸ª session å¯ä»¥ä¿å­˜åœ¨æœåŠ¡å™¨å†…å­˜ä¸­ï¼Œä¹Ÿå¯ä»¥ä¿å­˜åˆ°æ•°æ®åº“ä¸­
- åˆ›å»º session åï¼Œä¼šæŠŠå…³è”çš„ session_id é€šè¿‡ setCookie æ·»åŠ åˆ° http å“åº”å¤´ä¸­
- æµè§ˆå™¨åœ¨åŠ è½½é¡µé¢æ—¶å‘ç°ç›¸åº”å¤´éƒ¨æœ‰ set-cookie å­—æ®µï¼Œå°±æŠŠè¿™ä¸ª cookie ç§åˆ°æµè§ˆå™¨æŒ‡å®šåŸŸåä¸‹
- å½“ä¸‹æ¬¡åˆ·æ–°é¡µé¢æ—¶ï¼Œå‘é€çš„è¯·æ±‚ä¼šå¸¦ä¸Šè¿™æ¡ cookieï¼ŒæœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°åæ ¹æ®è¿™ä¸ª session_id æ¥è¯†åˆ«ç”¨æˆ·
- cookie æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨é‡Œçš„ä¸€å°æ®µæ•°æ®ï¼Œè€Œ session æ˜¯æœåŠ¡å™¨ç”¨æ¥è¯†åˆ«èº«ä»½çš„ä¸€æ®µæ•°æ®ï¼Œæœ‰æ—¶å€™ä¹Ÿç‰¹æŒ‡èº«ä»½è¯†åˆ«æœºåˆ¶

session é‰´æƒ

jwt é‰´æƒ

### session storage

å’Œ localStorage ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äº localStorage é‡Œé¢å­˜å‚¨çš„æ•°æ®æ²¡æœ‰è¿‡æœŸæ—¶é—´è®¾ç½®ï¼Œè€Œå­˜å‚¨åœ¨ sessionStorage é‡Œé¢çš„æ•°æ®åœ¨é¡µé¢ä¼šè¯ç»“æŸæ—¶ä¼šè¢«æ¸…é™¤

> ğŸ¥¯ ç»™ localStorage è®¾ç½®è¿‡æœŸæ—¶é—´
