---
title: Vim —— 写代码更高效
date: 2022-11-15 15:06
updated: 2023-03-10 13:04
cover: //cdn.wallleap.cn/img/post/1.jpg
author: Luwang
comments: true
aliases:
  - 文章别名
rating: 10
tags:
  - blog
  - Vim
category: web
keywords:
  - 关键词1
  - 关键词2
  - 关键词3
description: 文章描述
source: null
url: null
---

Vim 是从 vi 发展出来的一个文本编辑器。代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。

简单的来说， vi 是老式的字处理器，不过功能已经很齐全了，但是还是有可以进步的地方。 vim 则可以说是程序开发者的一项很好用的工具。

连 vim 的官方网站 (<https://www.vim.org/>) 自己也说 vim 是一个程序开发工具而不是文字处理软件。

![键盘图](https://cdn.wallleap.cn/img/pic/illustrtion/202208121721944.gif)

## （一）三种模式

基本上 vi/vim 共分为三种模式，分别是**正常模式（Normal Mode）**、**输入模式（Insert Mode）** 和 **命令模式（Line mode）**。

三种模式相互切换：

- 正常模式：是进入 Vim 的默认模式，这个模式可以用各种指令实现快捷操作
	- <kbd>i</kbd> 插入字符，会进入输入模式
	- <kbd>:</kbd> 切换到命令模式，一般在底部会显示输入的命令
- 输入模式：可以像正常的编辑器一样输入文本
	- <kbd>ESC</kbd> 退出输入模式，回到正常模式
- 命令模式：在这个模式下可以实现保存、退出等操作
	- `q` 退出 Vim，后面加`!`可以强制执行
	- `w` 保存文件

## （二）记单词

除了移动其他的基本上都是单词首字母

移动：

- `hjkl`，以<kbd>k</kbd>键为基准，左边一个键（左移的），右边两个键分别是上右

- 上下左右键

- 可以搭配数字使用，`数字+方向`，例如：`30j`代表往上30行，`2→`代表右移两格

```code
    ^
    k		 提示： h 的键位于左边，每次按下就会向左移动。
< h   l >		   l 的键位于右边，每次按下就会向右移动。
    j			   j 键看起来很象一支尖端方向朝下的箭头。
    v
```

- `w` / `W` to move **word** by word
- `b` / `B` to move **backwards** word by word
- `e` to jump to the **end** of a word
- `ge` to jup to the end of the previous word
- `E` is like `e` but operates on WORDS
- `gE` is like `ge` but operates on WORDS
- `0`: Moves to the first character of a line
- `^`: Moves to the first non-blank character of a line
- `$`: Moves to the end of a line
- `g_`: Moves to the non-blank character at the end of a line
- `}` jumps entire paragraphs downwards
- `{` similarly but upwards
- `CTRL-D` lets you move down half a page by scrolling the page
- `CTRL-U` lets you move up half a page also by scrolling

常用操作：;

- 删除光标所在行：<kbd>dd</kbd>
- 删除标签内的内容：光标在标签内 <kbd>dit</kbd> （delete in tag） 好像只能在 VSCode 里用
- 删除花括号 `{}` 中的内容：光标先移动到花括号中 <kbd>c</kbd> + <kbd>i</kbd> + <kbd>Shift</kbd> + <kbd>[</kbd>（change in 花括号） 还可以是单引号 `''`、圆括号 `()` 等

## 一、Vim 模式

- 编辑模式 : 键盘操作通常被解析为编辑命令
- 输入模式 : 大部分键盘操作被存储到文档中
- 末行模式 : 用于解释运行 Vim 内置命令

## 二、模式切换

### 1、 编辑模式 –> 输入模式

- `i` : 在当前光标所在处输入
- `I` : 在当前光标所在行的行首输入
- `a` : 在当前光标所在处后方输入
- `A` : 在当前光标所在行行尾输入
- `o` : 在光标所在行的下方新增空白行
- `O` : 在当前所在行的上方新增空白行

### 2、输入模式 –> 编辑模式

- `ESC` : 从输入模式返回编辑模式

### 3、编辑模式 –> 末行模式

- `:` : 从编辑模式进入末行模式，两次 ESC 返回到编辑模式

## 三、Vim 常用命令

### 1、退出

- `:q!` : 不保存退出
- `:wq` : 保存并退出
- `:x` : 保存并退出
- `ZZ` : 保存并退出(编辑模式)
- `:wq!` : 强制保存并退出
- `:qall` : 多文件打开时退出所有文件
- `:wqall` : 保存并退出所有文件

### 2、打开

- `vim FILE1 FILE2 ...` : 打开多个文件

	- `:next` : 跳转到下一个文件
	- `:first` : 跳转到第一个文件
	- `:last` : 跳转到最后一个文件
	- `:prev` : 跳转到前一个文件

- `vim -o FILE1 FILE2 ...` : 以上下分屏模式打开所有文件

- `vim -O FILE1 FILE2 ...` : 一左右分屏方式打开所有文件

	- `Ctrl+W` 在按上下/左右箭头 切换编辑区

- `Ctrl+w,s` : 对当前文件进行上下分屏显示，类似 `-o`

- `Ctrl+w,v` : 对当前文件进行左右分屏显示，类似 `-O`

- `vim +# FILE` : 打开文件，并将光标定位到 # 行位置，不加数字则代表定位在文档末尾

### 3、光标移动

**编辑模式下**

- `[#] h` : 向左移动[#]字符，不写默认1
- `[#] l` : 向右移动[#]字符，不写默认1
- `[#] j` : 向下移动[#]行，不写默认1
- `[#] k` ; 向上移动[#]行，不写默认1
- `w` : 跳至下一个单词的词首
- `b` : 跳至当前/上一个单词词首
- `e` : 跳至当前/下一个单词词尾
- `^` : 跳转到当前行首
- `$` : 跳转到当前行尾(包含空白行)
- `0` : 跳转到当前行首(包含空白行)
- `)` : 跳转到下一句行尾
- `(` : 跳转到上一句行首
- `}` : 跳转到下一段行尾
- `{` : 跳转到上一段行首
- `[#] G` : 跳转到指定行，不写则默认文档最后一行
- `Ctrl+f` : 向下翻一屏
- `Ctrl+b` : 向上翻一屏
- `Ctrl+d` : 向下翻半屛
- `Ctrl+u` : 向上翻半屛

### 4、编辑

- `[#] x` : 删除光标所在处其后的 # 个字符，不写删除当前字符
- `r 字符` : 替换光标所在处为指定字符
- `d [***]` : 删除命令，可配合光标跳转命令删除字符
	- `d w` : 删除光标后一个单词
	- `d b` : 删除光标前一个单词
	- `d $` : 删除光标后到行尾所有内容
	- `d ^` : 删除光标到行首所有内容
	- `[#] d d` : 删除光标所在处后 # 行，不写删除当前行

**末行模式下**

- `START,END d` : 删除 START 到 END 行内容

- `SATRT,+# d` : 删除 START 行开始向后的 # 行内容

- `+#,END d` : 删除从 END 行开始向上的前 # 行内容

- `$ d` : 删除当前行开始到文件末尾

- `. d` : 删除当前行

- `.,$-2` : **支持组合删除，前面的代表删除当前行开始，到文件末尾-2 行的所有内容**

- `% d` : 删除全文

- `/pat1/,/pat2/ d` : 从光标所在行开始，删除从第一次被 pat1 匹配到的行开始到第一次被 pat2 匹配带的行结束 中间的所有行

- `c [***]` : 改变命令，先删除内容再切换到输入模式，同 `d` 命令相同，可配合光标跳转命令改变字符

	- `[#] c c` : 删除光标所在处 # 行并进入输入模式，不写默认删除当前行并进入输入模式

- `y [***]` : 复制命令，配合光标跳转命令使用，`[#] yy` 复制当前行开始的向下 # 行，不写默认复制当前行

- `p` : 粘贴当前光标所在位置的后面(可能是行或者单词，取决于复制的内容)

- `P` : 粘贴当前光标所在位置的前面(可能是行或者单词，取决于复制的内容)

- `u` : 撤销修改

- `Ctrl+r` : 撤销此前的撤销命令

- `.` : 重复此前命令

### 5、查找

- `/keyword` : 向下查找

- `?keyword` : 向上查找

- `n` : 向下循环查找

- `N` : 向上循环查找

- `set hlsearch` : 开启高亮查找

- `set nohlsearch` : 关闭高亮查找

### 6、可视化模式

- `v` : 进入可视化，按照单词选择
- `V` : 进入可视化，按照行选择

## 四、窗口属性设置

- `set nu` : 显示行号
- `set nonu` : 取消显示行号
- `set ai` : 自动缩进
- `set noai` : 取消自动缩进
- `set ic` : 搜索忽略大小写
- `set noic` : 取消搜索忽略大小写
- `set sm` : 显示与之匹配的括号
- `set nosm` : 取消与之显示的括号
- `syntax on` : 开启语法高亮
- `syntax off` : 关闭语法高亮
- `set hlsearch` : 开启搜索高亮
- `set nohlsearch` : 关闭搜索高亮

## 五、配置文件

- 全局配置文件存放于 `/etc/vimrc`
- 用户配置文件存放于 `~/.vimrc`

## 六、查找替换

**末行模式下**

- `命令格式` : `地址定界s/查找模式/替换内容/gi`

	- `s` : 替换命令，可换成删除 `d` 等
	- `g` : global，全局操作，**默认的 vim 搜索替换只匹配每行中的第一个被模式匹配的字符，如果有多个则忽略，g 代表全部替换**
	- `i` : 忽略大小写

- **对于分隔符 `/` 可以自定义，默认的 vim 认为紧跟在编辑命令 `s` 后的字符即为分隔符，所以为了避免路径替换时对 `/` 做转义可以使用自定义格式，如 `地址定界s@匹配模式@替换内容@gi`**

- `&` : 用于引用前面 **查找模式** 所匹配到的所有字符，**通常用于插入式替换**，如在非注释行前加入 `#` 注释符 : `1,$s/^[^#].*/#&/gi`
